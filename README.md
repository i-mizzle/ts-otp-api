# ts-otp-api
This Api was created as part of the fulstack developer test for gerald Inc.

## Available Scripts
In the project directory, after setting up your environment variables in the .env file (use dotenv-sample as a guide) you can run

## npm install
To install all the dependencies

## npm run dev
launches the application

## Application File Structure
Te application logic is separated into: routes, controllers, middleware, model, schema, responses, service, utils

### The routes
The routes file contains all of the endpoints defined for the application and it directs traffic to the controllers responsible for handling the requests 

### The controller
The controller only passes data gotten from the endpoints to the services responsible for processing the data.
The controller contains two methods:
- createOtpHandler: this generates the otp by calling the service createOtp()
- compareOtpHandler: this compares the provided otp to the otp in the database against the provided phone number by calling the compareOtp() function

### The services
The services receive tasks from the controller along with a payload and they are responsible for creating fetching and manipulating data from the database. the following services are providded:
- createOtp: This calls the database with the phone number as provided from the frontend and saves a generated otp (generated by calling a utility function generateOtp()) with an expiry time (60 seconds from the current time) and saves along with the phonenumber 
- compareOtp: this receives an otp and a phone number from the controller and queries the database to find that otp stored against the phone number. If the combination exists in the database, it checks if it's still valid and returns the appropriate response

### The model
The model contains definition of the database structure. In this case, it defines the data structure as:
- PhoneNumber: the phone number that the otp is generated against and that will be used to do comparison. this is saved as a string
- otp: the generated 6-digit OTP - saved as a string
- expiry: time in milliseconds that it will take for the otp to expire. during comparison, this number is compared with the current time in milliseconds

### Utils
This holds utility functions that support the application. In this application, it contains: 
- generateCode: this is a simple functions that generates and returns a random code. the user can specify the length and content(numeric or not) of the code

### The middleware
The model contains functions to be run before getting into the application 
 


